<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diseases VR</title>

    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>

    <!-- Library of Virtual Reality -->
    <script type="text/javascript" charset="UTF-8" src="../../libs/aframe-master.js"></script>

    <script>
        AFRAME.registerComponent('cursor-listener', {
            init: function () {
                var lastIndex = -1;
                var COLORS = ['red', 'green', 'blue', 'purple'];
                this.el.addEventListener('click', function (evt) {
                    lastIndex = (lastIndex + 1) % COLORS.length;
                    this.setAttribute('material', 'color', COLORS[lastIndex]);
                    console.log('I was clicked at: ', evt.detail.intersection.point);
                });
            }
        });
        AFRAME.registerComponent('controls', {
            init: function () {
                this.gamepad;
                this.model = document.querySelector('#aneurism').object3D;
                this.camera = document.querySelector('#camera').object3D;

                this.cursor = document.querySelector('#cursor');

                console.log(this.cursor);
            },
            tick: function (time, delta) {
                this.gamepad = navigator.getGamepads()[0];
                if (!this.gamepad) return;

                if (this.gamepad.axes[0] !== 0) {
                    this.model.rotation.y += 0.002 * delta * this.gamepad.axes[0];
                }

                if (this.gamepad.axes[1] !== 0) {
                    this.camera.position.z += 0.002 * delta * this.gamepad.axes[1];
                }

            }
        });
    </script>
</head>

<body>
    <a-scene main_scene id="scene">
        <a-assets timeout="3000">
            <a-asset-item id="strokeModel" src="../../assets/models/diseases/an.glb"></a-asset-item>
            <!-- <img id="text" src="assets/textures/text.png"> -->
        </a-assets>

        <a-entity light="type: ambient; color: #fff; intensity: 0.3"></a-entity>
        <a-entity light="color: #fff" position="-65 110 0"></a-entity>

        <a-sky color="#343434"></a-sky>

        <a-entity id="aneurism" position="-1 0 0" gltf-model="#strokeModel" controls></a-entity>

        <a-plane position="0 0 0" rotation="-90 0 0" width="10" height="10" color="#A1ACB3"
            material="transparent: true; opacity: 0.5"></a-plane>

        <a-plane id="panel" class="clickable" cursor-listener position="-0.5 1.5 3" rotation="0 90 0" width="0.1"
            height="0.05" material="">
        </a-plane>
        <a-plane id="panel" class="clickable" cursor-listener position="-0.5 1.5 2.9" rotation="0 90 0" width="0.1"
            height="0.05" material="">
        </a-plane>
        <a-plane id="panel" class="clickable" cursor-listener position="-0.5 1.5 2.8" rotation="0 90 0" width="0.1"
            height="0.05" material="">
        </a-plane>
        <a-plane id="panel" class="clickable" cursor-listener position="-1 1.5 2.7" rotation="0 90 0" width="0.1"
            height="0.05" material="">
        </a-plane>

        <a-entity id="rig" position="0 0 3">
            <a-entity id="camera" camera position="0 1.6 0" look-controls="pointerLockEnabled: true">
                <a-entity cursor="fuse: true; fuseTimeout: 500" raycaster="objects: .clickable" position="0 0 -0.5"
                    geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                    material="color: black; shader: flat">
                </a-entity>
            </a-entity>
        </a-entity>

    </a-scene>

</body>

</html>